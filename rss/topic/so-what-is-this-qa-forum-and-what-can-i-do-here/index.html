<?
/*
Plugin Name: bb Topic Icons
Plugin URI: http://devt.caffeinatedbliss.com/bbpress/topic-icons
Description: Adds configurable icons next to topics based on their status
Author: Paul Hawke
Author URI: http://paul.caffeinatedbliss.com/
Version: 0.6
*/

/****************************************************************************
 *
 * Configure the following constants to fine-tune the CSS classes that are
 * generated, the icon filenames that are used, and the text used in the
 * legend (if you have one displayed).  Note: filenames are likely to be
 * taken away in a future version and replaced with the concept of "icon sets"
 * whose filenames are fixed, so dont get used to editing the filenames,
 * as this will break in future versions.
 *
 ****************************************************************************/

// css class for the unsorted list used in the legend display
define( LEGEND_CLASS, 'topic_icon_legend' );

// busy threshold - a topic with more posts than this is counted as "busy"
// for purposes of picking an icon.
define( BUSY_THRESHOLD, 15 );

// width of the images, in pixels
define( ICON_WIDTH, '20' );

// height of the images, in pixels
define( ICON_HEIGHT, '20' );

// the URL base for where to find the default icon set.
define( ICON_SET_URL_BASE, BB_PLUGIN_URL.'bb-topic-icons/icon-sets/' );

/****************************************************************************
 *
 * Shouldnt be much need to edit anything beyond this point - configuration
 * is all done via the constants (above) and through and admin area page in
 * bbPress at runtime.
 *
 ****************************************************************************/

require( 'bb-topic-icons-api.php' );
require( 'bb-topic-icons-admin.php' );
require( 'interface.status-interpreter.php' );
require( 'interface.status-renderer.php' );
require( 'class.default-status-interpreter.php' );
require( 'class.default-status-renderer.php' );

function topic_icons_legend() {
	$icon_set_name = topic_icons_get_active_icon_set();
	$icon_set_url = ICON_SET_URL_BASE . $icon_set_name;
	$statuses = get_active_status_interpreter()->getAllStatuses();
	$renderer = get_active_status_renderer();
	
	echo '<ul id="'.LEGEND_CLASS.'">';
	for ($i=0; $i < count($statuses); $i++) {
		$image = $renderer->renderStatus($statuses[$i]);
		$tooltip = $renderer->renderStatusTooltip($statuses[$i]);
		$exists = file_exists(dirname(__FILE__).'/icon-sets/'.$icon_set_name.'/'.$image);

		if (isset($image) && strlen($image) > 0 &&
			isset($tooltip) && strlen($tooltip) > 0 && $exists) {
			echo '<li><img src="'.$icon_set_url.'/'.$image.
				'" width="'.ICON_WIDTH.'" height="'.ICON_HEIGHT.
				'" align="absmiddle">&nbsp;'.$tooltip.'</li>';
		}
	}
	echo '</ul>';
}

function topic_icons_css() {
	echo "\n<style type=\"text/css\"><!--\n";
	require( 'bb-topic-icons.css' );
	echo "\n--></style>";
}

function topic_icons_label( $label ) {
	global $topic;
	
	if (bb_is_front() || bb_is_forum() || bb_is_view() || bb_is_tag()) {		
		$icon_set_name = topic_icons_get_active_icon_set();
		$icon_set_url = ICON_SET_URL_BASE . $icon_set_name;

		$status = get_active_status_interpreter()->getStatus(bb_get_location(), $topic);
		$renderer = get_active_status_renderer();
		$image = $renderer->renderStatus($status);
		$tooltip = $renderer->renderStatusTooltip($status);
		$exists = file_exists(dirname(__FILE__).'/icon-sets/'.$icon_set_name.'/'.$image);

		if (!$exists) {
			return sprintf(__('<div class="topic-icon-image"><a href="%s"><img src="%s" width="%s" height="%s" alt="%s" border="0"></a></div> %s'), 
				get_topic_link($topic->topic_id), ICON_SET_URL_BASE.'/empty.png', ICON_WIDTH, ICON_HEIGHT, $tooltip, $label);
		} else if (strlen($tooltip) > 0) {		
			return sprintf(__('<div class="topic-icon-image"><a href="%s"><img src="%s" width="%s" height="%s" alt="%s" border="0"><span>%s</span></a></div> %s'), 
				get_topic_link($topic->topic_id), $icon_set_url.'/'.$image, ICON_WIDTH, ICON_HEIGHT, $tooltip, $tooltip, $label);
		} else {
			return sprintf(__('<div class="topic-icon-image"><a href="%s"><img src="%s" width="%s" height="%s" alt="%s" border="0"></a></div> %s'), 
				get_topic_link($topic->topic_id), $icon_set_url.'/'.$image, ICON_WIDTH, ICON_HEIGHT, $tooltip, $label);
		}
	}
	
	return $label;
}

function topic_icons_init( ) {
	remove_filter('bb_topic_labels', 'bb_closed_label', 10);
	remove_filter('bb_topic_labels', 'bb_sticky_label', 20);

	add_filter('bb_topic_labels', 'topic_icons_label', 11);

	add_action('bb_head', 'topic_icons_css');

	add_action('bb_admin_menu_generator', 'topic_icons_admin_page_add');
	add_action('bb_admin-header.php', 'topic_icons_admin_page_process');
	
	topic_icons_register_status_interpreter('default', new DefaultStatusInterpreter(BUSY_THRESHOLD));
	topic_icons_register_status_renderer('default', new DefaultStatusRenderer());
}

topic_icons_init();

?>
<?xml version="1.0" encoding="UTF-8"?>
<!-- generator="bbPress/1.0.2" -->
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom">
	<channel>
		<title>Digital Humanities Questions &#38; Answers &#187; Topic: So, what is this Q&#38;A forum, and what can I do here?</title>
		<link>http://digitalhumanities.org/answers/topic/so-what-is-this-qa-forum-and-what-can-i-do-here</link>
		<description>Digital Humanities Questions &amp; Answers &#187; Topic: So, what is this Q&amp;A forum, and what can I do here?</description>
		<language>en-US</language>
		<pubDate>Sun, 24 Mar 2019 17:08:35 +0000</pubDate>
		<generator>http://bbpress.org/?v=1.0.2</generator>
		<textInput>
			<title><![CDATA[Search]]></title>
			<description><![CDATA[Search all topics from these forums.]]></description>
			<name>q</name>
			<link>http://digitalhumanities.org/answers/search.php</link>
		</textInput>
		<atom:link href="http://digitalhumanities.org/answers/rss/topic/so-what-is-this-qa-forum-and-what-can-i-do-here" rel="self" type="application/rss+xml" />

		<item>
			 
				<title>Bethany Nowviskie on "So, what is this Q&#38;A forum, and what can I do here?"</title>
						<link>http://digitalhumanities.org/answers/topic/so-what-is-this-qa-forum-and-what-can-i-do-here#post-55</link>
			<pubDate>Wed, 08 Sep 2010 18:47:04 +0000</pubDate>
			<dc:creator>Bethany Nowviskie</dc:creator>
			<guid isPermaLink="false">55@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;My goodness, the community of digital humanists here at DHanswers &#60;strong&#62;really is&#60;/strong&#62; helpful!  And I see we've written &#60;a href=&#34;http://digitalhumanities.org/answers/topic/how-can-i-find-info-thats-already-been-discussed-help-dhanswers-grow&#34;&#62;even more tips&#60;/a&#62; on using the site!&#60;/p&#62;
&#60;p&#62;Thanks for creating this space, &#60;a href=&#34;http://ach.org&#34;&#62;ACH&#60;/a&#62; and &#60;a href=&#34;http://profhacker.com&#34;&#62;ProfHacker&#60;/a&#62;.&#60;/p&#62;
&#60;p&#62;[Exeunt, pursued by a Bear.]
&#60;/p&#62;</description>
		</item>
		<item>
			 
				<title>Joe Gilbert on "So, what is this Q&#38;A forum, and what can I do here?"</title>
						<link>http://digitalhumanities.org/answers/topic/so-what-is-this-qa-forum-and-what-can-i-do-here#post-54</link>
			<pubDate>Tue, 07 Sep 2010 20:45:02 +0000</pubDate>
			<dc:creator>Joe Gilbert</dc:creator>
			<guid isPermaLink="false">54@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;If a question can be solved by a bit of code, you can follow the example listed below the &#34;post my question&#34; button to format and highlight syntax.&#60;/p&#62;
&#60;p&#62;For example, by surrounding this text with the right &#34;pre&#34; tag:&#60;br /&#62;
function hello_world() {&#60;br /&#62;
     echo &#34;Hello, World!&#34;;&#60;br /&#62;
}&#60;/p&#62;
&#60;p&#62;we can generate this PHP snippet:&#60;/p&#62;


&#60;div class=&#34;bb_syntax&#34;&#62;&#60;table&#62;&#60;tr&#62;&#60;td class=&#34;line_numbers&#34;&#62;&#60;pre&#62;1
2
3
&#60;/pre&#62;&#60;/td&#62;&#60;td class=&#34;code&#34;&#62;&#60;pre class=&#34;php&#34; style=&#34;font-family:monospace;&#34;&#62;&#60;span style=&#34;color: #000000; font-weight: bold;&#34;&#62;function&#60;/span&#62; hello_world&#60;span style=&#34;color: #009900;&#34;&#62;&#38;#40;&#60;/span&#62;&#60;span style=&#34;color: #009900;&#34;&#62;&#38;#41;&#60;/span&#62; &#60;span style=&#34;color: #009900;&#34;&#62;&#38;#123;&#60;/span&#62;
     &#60;span style=&#34;color: #b1b100;&#34;&#62;echo&#60;/span&#62; &#60;span style=&#34;color: #0000ff;&#34;&#62;&#38;quot;Hello, World!&#38;quot;&#60;/span&#62;&#60;span style=&#34;color: #339933;&#34;&#62;;&#60;/span&#62;
&#60;span style=&#34;color: #009900;&#34;&#62;&#38;#125;&#60;/span&#62;&#60;/pre&#62;&#60;/td&#62;&#60;/tr&#62;&#60;/table&#62;&#60;/div&#62;


</description>
		</item>
		<item>
			 
				<title>Joe Gilbert on "So, what is this Q&#38;A forum, and what can I do here?"</title>
						<link>http://digitalhumanities.org/answers/topic/so-what-is-this-qa-forum-and-what-can-i-do-here#post-53</link>
			<pubDate>Tue, 07 Sep 2010 20:36:35 +0000</pubDate>
			<dc:creator>Joe Gilbert</dc:creator>
			<guid isPermaLink="false">53@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;&#60;em&#62;Replying to @Bethany Nowviskie's &#60;a href=&#34;http://digitalhumanities.org/answers/topic/so-what-is-this-qa-forum-and-what-can-i-do-here#post-49&#34;&#62;post&#60;/a&#62;:&#60;/em&#62;&#60;/p&#62;
&#60;p&#62;Bethany, there are lots of ways to keep track of the conversation in addition to following &#60;a href=&#34;http://twitter.com/dhanswers&#34;&#62;@DHAnswers&#60;/a&#62;.  You can follow RSS feeds for &#60;a href=&#34;http://digitalhumanities.org/answers/rss/&#34;&#62;all recent Q&#38;amp;A messages&#60;/a&#62; or &#60;a href=&#34;http://digitalhumanities.org/answers/rss/topics/&#34;&#62;new questions only&#60;/a&#62;.  Look for links like the one at the bottom of this thread for question-specific feeds.  There are category and tag feeds, too!&#60;/p&#62;
&#60;p&#62;At the top of the Q&#38;amp;A thread, you'll find a link to add this question to your favorites.  By changing some settings in your profile (look for you user name at the very top-right of the page), you can subscribe to an RSS feed of your favorite questions or even receive emails when new things are posted to your favorite questions (or all questions if you're a real DHAnswers enthusiast!).&#60;/p&#62;
&#60;p&#62;As Julie says, questioners (and moderators) can award well-answered questions with a soon-to-be-coveted green &#34;best answer&#34; check mark.  Questions can have multiple &#34;best answers,&#34; so feel free to be generous to good responses.  On the front page, you can search for only questions that have best answers (if you're looking for existing solutions) or only those without a best answer (if you're feeling helpful).
&#60;/p&#62;</description>
		</item>
		<item>
			 
				<title>Julie Meloni on "So, what is this Q&#38;A forum, and what can I do here?"</title>
						<link>http://digitalhumanities.org/answers/topic/so-what-is-this-qa-forum-and-what-can-i-do-here#post-50</link>
			<pubDate>Mon, 06 Sep 2010 15:06:58 +0000</pubDate>
			<dc:creator>Julie Meloni</dc:creator>
			<guid isPermaLink="false">50@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;I think Stéfan has answered &#34;what kind of questions should I be asking&#34; pretty well, so I'll tackle some tips and tricks for asking good questions--the kind that are likely to garner the best responses.&#60;/p&#62;
&#60;ul&#62;
&#60;li&#62;Be as specific as possible in the little space you have for the question. For example, &#34;Linux command line conversion of doc to docx&#34; is a pretty specific question, but &#34;document help&#34; would not be.  The more specific the question, the greater the chance someone will answer it quickly.&#60;/li&#62;
&#60;li&#62;Within the body of the post itself, take a moment to document the process you already went through to find an answer.  For example, &#34;I looked at Forum X but it was unhelpful&#34; will allow us to be more efficient in our answer for we will neither have to go look at Forum X ourselves nor tell you to go look at Forum X. Instead, we can begin to find a better path to the answer, together.&#60;/li&#62;
&#60;li&#62;Whenever possible, if you are looking for help with a specific problem (tool usage comes to mind here), describe the environment in which it occurs, the diagnostic steps you took to figure out where the problem is occurring, any changes you made to the software or configuration, and, if you know, what you think you might try/what might be the problem, even if you’re hesitant to do it.&#60;/li&#62;
&#60;li&#62;When asking about code, remember that just saying &#34;it doesn't work&#34; is not the most helpful thing to do. Instead, something like &#34;I am getting this error [paste it here] when I do [x task]. Here is the code around that line&#34; (or something similar) is really helpful.&#60;/li&#62;
&#60;li&#62;Follow up--you can do that in DHAnswers by marking an answer as &#34;best answer&#34; or even just replying to the thread. Even if a suggestion fixes the problem, let the person know that it’s fixed. Speaking for myself, I know that when I am asked to help with something and I offer suggestions, I automatically care about the result.&#60;/li&#62;
&#60;/ul&#62;
&#60;p&#62;As to the question &#34;And who is here to help me?&#34; the short answer is &#60;strong&#62;we don't know yet, but hopefully everyone&#60;/strong&#62;.  Ok, that's not entirely true.  The DHAnswers team has invited a range of folks with skills and experience in many areas to keep an eye on topics and take a bit of ownership of certain categories.  But as more people use DHAnswers and add to the collective knowledgebase, we expect the core group to shift over time.  We recommend viewing users' profile pages as they answer your questions, to learn a little more about the people behind the username.&#60;/p&#62;
&#60;p&#62;At this time the core DHAnswers team includes the first three people writing in this topic (Bethany Nowviskie, Stéfan Sinclair, Julie Meloni) plus Joe Gilbert (who did most of the work).
&#60;/p&#62;</description>
		</item>
		<item>
			 
				<title>Bethany Nowviskie on "So, what is this Q&#38;A forum, and what can I do here?"</title>
						<link>http://digitalhumanities.org/answers/topic/so-what-is-this-qa-forum-and-what-can-i-do-here#post-49</link>
			<pubDate>Mon, 06 Sep 2010 14:55:35 +0000</pubDate>
			<dc:creator>Bethany Nowviskie</dc:creator>
			<guid isPermaLink="false">49@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;Wow, that sounds great! I'll definitely start following &#60;a&#62;@DHanswers&#60;/a&#62; on Twitter, so I can keep up with the latest questions. &#60;/p&#62;
&#60;p&#62;Are there other ways I can follow particular conversations? RSS feeds? Email notifications? And how can I tell if a question has gotten an especially good answer?
&#60;/p&#62;</description>
		</item>
		<item>
			 
				<title>Stéfan Sinclair on "So, what is this Q&#38;A forum, and what can I do here?"</title>
						<link>http://digitalhumanities.org/answers/topic/so-what-is-this-qa-forum-and-what-can-i-do-here#post-48</link>
			<pubDate>Mon, 06 Sep 2010 14:43:02 +0000</pubDate>
			<dc:creator>Stéfan Sinclair</dc:creator>
			<guid isPermaLink="false">48@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;Well, Bethany, I'm so glad you asked :)&#60;/p&#62;
&#60;p&#62;Let me start with the question &#34;what kind of questions should I be asking?&#34;. My take on that is that it's probably best to not hesitate in asking any kind of question (within the context of a community-oriented digital humanities forum – I'm not sure it's the best venue for, say, advice on choosing a school in your local area:).&#60;/p&#62;
&#60;p&#62;The hardest thing to judge may be the scope of questions: is it too trivial or technical? is it too broad or theoretical? Personally, I think anything goes. Let the forum community decide how much time and energy is warranted – if you have a question, ask it.&#60;/p&#62;
&#60;p&#62;For people with questions, I think there are two main uses for the site:&#60;/p&#62;
&#60;p&#62;1) searching/browsing for answers on previously asked questions&#60;br /&#62;
2) asking a new question and hopefully getting an answer (or more) fairly quickly&#60;/p&#62;
&#60;p&#62;Getting answers quickly was a major part of the design of the site, and in particular the twitter integration. When you post a new question it gets tweeted under the site's own twitter account (not necessarily your own, though you can do that too). We anticipate that there will be a good number of followers of the twitter account and that the question will be seen and addressed in a timely manner.&#60;/p&#62;
&#60;p&#62;I think the best way to view this site is as crowd-sourced digital humanities expertise!
&#60;/p&#62;</description>
		</item>
		<item>
			 
				<title>Bethany Nowviskie on "So, what is this Q&#38;A forum, and what can I do here?"</title>
						<link>http://digitalhumanities.org/answers/topic/so-what-is-this-qa-forum-and-what-can-i-do-here#post-47</link>
			<pubDate>Mon, 06 Sep 2010 00:17:17 +0000</pubDate>
			<dc:creator>Bethany Nowviskie</dc:creator>
			<guid isPermaLink="false">47@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;[Welcome to the only canned, pro-forma question in DHanswers!]&#60;/p&#62;
&#60;p&#62;Gee, I'm wondering if you can tell me a little more about this site.  What's it for?  What kind of questions should I be asking?  Any tips and tricks?  And who is here to help me?
&#60;/p&#62;</description>
		</item>

	</channel>
</rss>
