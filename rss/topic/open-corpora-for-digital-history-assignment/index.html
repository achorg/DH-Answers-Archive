<?
/*
Plugin Name: bb Topic Icons
Plugin URI: http://devt.caffeinatedbliss.com/bbpress/topic-icons
Description: Adds configurable icons next to topics based on their status
Author: Paul Hawke
Author URI: http://paul.caffeinatedbliss.com/
Version: 0.6
*/

/****************************************************************************
 *
 * Configure the following constants to fine-tune the CSS classes that are
 * generated, the icon filenames that are used, and the text used in the
 * legend (if you have one displayed).  Note: filenames are likely to be
 * taken away in a future version and replaced with the concept of "icon sets"
 * whose filenames are fixed, so dont get used to editing the filenames,
 * as this will break in future versions.
 *
 ****************************************************************************/

// css class for the unsorted list used in the legend display
define( LEGEND_CLASS, 'topic_icon_legend' );

// busy threshold - a topic with more posts than this is counted as "busy"
// for purposes of picking an icon.
define( BUSY_THRESHOLD, 15 );

// width of the images, in pixels
define( ICON_WIDTH, '20' );

// height of the images, in pixels
define( ICON_HEIGHT, '20' );

// the URL base for where to find the default icon set.
define( ICON_SET_URL_BASE, BB_PLUGIN_URL.'bb-topic-icons/icon-sets/' );

/****************************************************************************
 *
 * Shouldnt be much need to edit anything beyond this point - configuration
 * is all done via the constants (above) and through and admin area page in
 * bbPress at runtime.
 *
 ****************************************************************************/

require( 'bb-topic-icons-api.php' );
require( 'bb-topic-icons-admin.php' );
require( 'interface.status-interpreter.php' );
require( 'interface.status-renderer.php' );
require( 'class.default-status-interpreter.php' );
require( 'class.default-status-renderer.php' );

function topic_icons_legend() {
	$icon_set_name = topic_icons_get_active_icon_set();
	$icon_set_url = ICON_SET_URL_BASE . $icon_set_name;
	$statuses = get_active_status_interpreter()->getAllStatuses();
	$renderer = get_active_status_renderer();
	
	echo '<ul id="'.LEGEND_CLASS.'">';
	for ($i=0; $i < count($statuses); $i++) {
		$image = $renderer->renderStatus($statuses[$i]);
		$tooltip = $renderer->renderStatusTooltip($statuses[$i]);
		$exists = file_exists(dirname(__FILE__).'/icon-sets/'.$icon_set_name.'/'.$image);

		if (isset($image) && strlen($image) > 0 &&
			isset($tooltip) && strlen($tooltip) > 0 && $exists) {
			echo '<li><img src="'.$icon_set_url.'/'.$image.
				'" width="'.ICON_WIDTH.'" height="'.ICON_HEIGHT.
				'" align="absmiddle">&nbsp;'.$tooltip.'</li>';
		}
	}
	echo '</ul>';
}

function topic_icons_css() {
	echo "\n<style type=\"text/css\"><!--\n";
	require( 'bb-topic-icons.css' );
	echo "\n--></style>";
}

function topic_icons_label( $label ) {
	global $topic;
	
	if (bb_is_front() || bb_is_forum() || bb_is_view() || bb_is_tag()) {		
		$icon_set_name = topic_icons_get_active_icon_set();
		$icon_set_url = ICON_SET_URL_BASE . $icon_set_name;

		$status = get_active_status_interpreter()->getStatus(bb_get_location(), $topic);
		$renderer = get_active_status_renderer();
		$image = $renderer->renderStatus($status);
		$tooltip = $renderer->renderStatusTooltip($status);
		$exists = file_exists(dirname(__FILE__).'/icon-sets/'.$icon_set_name.'/'.$image);

		if (!$exists) {
			return sprintf(__('<div class="topic-icon-image"><a href="%s"><img src="%s" width="%s" height="%s" alt="%s" border="0"></a></div> %s'), 
				get_topic_link($topic->topic_id), ICON_SET_URL_BASE.'/empty.png', ICON_WIDTH, ICON_HEIGHT, $tooltip, $label);
		} else if (strlen($tooltip) > 0) {		
			return sprintf(__('<div class="topic-icon-image"><a href="%s"><img src="%s" width="%s" height="%s" alt="%s" border="0"><span>%s</span></a></div> %s'), 
				get_topic_link($topic->topic_id), $icon_set_url.'/'.$image, ICON_WIDTH, ICON_HEIGHT, $tooltip, $tooltip, $label);
		} else {
			return sprintf(__('<div class="topic-icon-image"><a href="%s"><img src="%s" width="%s" height="%s" alt="%s" border="0"></a></div> %s'), 
				get_topic_link($topic->topic_id), $icon_set_url.'/'.$image, ICON_WIDTH, ICON_HEIGHT, $tooltip, $label);
		}
	}
	
	return $label;
}

function topic_icons_init( ) {
	remove_filter('bb_topic_labels', 'bb_closed_label', 10);
	remove_filter('bb_topic_labels', 'bb_sticky_label', 20);

	add_filter('bb_topic_labels', 'topic_icons_label', 11);

	add_action('bb_head', 'topic_icons_css');

	add_action('bb_admin_menu_generator', 'topic_icons_admin_page_add');
	add_action('bb_admin-header.php', 'topic_icons_admin_page_process');
	
	topic_icons_register_status_interpreter('default', new DefaultStatusInterpreter(BUSY_THRESHOLD));
	topic_icons_register_status_renderer('default', new DefaultStatusRenderer());
}

topic_icons_init();

?>
<?xml version="1.0" encoding="UTF-8"?>
<!-- generator="bbPress/1.0.2" -->
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom">
	<channel>
		<title>Digital Humanities Questions &#38; Answers &#187; Topic: Open Corpora for Digital History Assignment</title>
		<link>http://digitalhumanities.org/answers/topic/open-corpora-for-digital-history-assignment</link>
		<description>Digital Humanities Questions &amp; Answers &#187; Topic: Open Corpora for Digital History Assignment</description>
		<language>en-US</language>
		<pubDate>Tue, 12 Mar 2019 02:01:43 +0000</pubDate>
		<generator>http://bbpress.org/?v=1.0.2</generator>
		<textInput>
			<title><![CDATA[Search]]></title>
			<description><![CDATA[Search all topics from these forums.]]></description>
			<name>q</name>
			<link>http://digitalhumanities.org/answers/search.php</link>
		</textInput>
		<atom:link href="http://digitalhumanities.org/answers/rss/topic/open-corpora-for-digital-history-assignment" rel="self" type="application/rss+xml" />

		<item>
			 
				<title>SharonHoward on "Open Corpora for Digital History Assignment"</title>
						<link>http://digitalhumanities.org/answers/topic/open-corpora-for-digital-history-assignment#post-2365</link>
			<pubDate>Tue, 08 Dec 2015 16:51:47 +0000</pubDate>
			<dc:creator>SharonHoward</dc:creator>
			<guid isPermaLink="false">2365@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;Lists of corpora compiled by historical linguists (some may be restricted access): &#60;a href=&#34;http://www.helsinki.fi/varieng/corpora/index.html&#34; rel=&#34;nofollow&#34;&#62;http://www.helsinki.fi/varieng/corpora/index.html&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;Oxford Texts Archive is full of amazing things (including EEBO-TCP texts), though students might have to register for access: &#60;a href=&#34;http://ota.ox.ac.uk/&#34; rel=&#34;nofollow&#34;&#62;http://ota.ox.ac.uk/&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;This huge list of museums/libraries etc data compiled by Mia Ridge emphasises APIs and linked open data but it's actually very wide-ranging: &#60;a href=&#34;http://museum-api.pbworks.com/w/page/21933420/Museum%C2%A0APIs&#34; rel=&#34;nofollow&#34;&#62;http://museum-api.pbworks.com/w/page/21933420/Museum%C2%A0APIs&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;The British Library is also making a varied assortment of datasets and text collections available through its BL Labs project: &#60;a href=&#34;http://labs.bl.uk/Digital+Collections&#34; rel=&#34;nofollow&#34;&#62;http://labs.bl.uk/Digital+Collections&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;Corpora from Mark Davies, BYU (including Hansard): &#60;a href=&#34;http://corpus.byu.edu/&#34; rel=&#34;nofollow&#34;&#62;http://corpus.byu.edu/&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;Some smaller collections that I like:&#60;/p&#62;
&#60;p&#62;Thomas Bodley Correspondence (XML) from the Centre for Lives and Letters: &#60;a href=&#34;https://github.com/livesandletters/bodley1&#34; rel=&#34;nofollow&#34;&#62;https://github.com/livesandletters/bodley1&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;Family Life and Work Experience Before 1918, 1870-1973 (transcripts of c. 450 oral history interviews + structured metadata): &#60;a href=&#34;https://discover.ukdataservice.ac.uk/catalogue/?sn=2000&#38;amp;type=Data%20catalogue&#34; rel=&#34;nofollow&#34;&#62;https://discover.ukdataservice.ac.uk/catalogue/?sn=2000&#38;amp;type=Data%20catalogue&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;Repository of Early American Datasets: &#60;a href=&#34;http://repository.upenn.edu/mead/&#34; rel=&#34;nofollow&#34;&#62;http://repository.upenn.edu/mead/&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;A new version of the Old Bailey Online Corpus is due to be released shortly and will be open data (the current version requires registration): &#60;a href=&#34;http://www1.uni-giessen.de/oldbaileycorpus/&#34; rel=&#34;nofollow&#34;&#62;http://www1.uni-giessen.de/oldbaileycorpus/&#60;/a&#62;
&#60;/p&#62;</description>
		</item>
		<item>
			 
				<title>Miriam Posner on "Open Corpora for Digital History Assignment"</title>
						<link>http://digitalhumanities.org/answers/topic/open-corpora-for-digital-history-assignment#post-2364</link>
			<pubDate>Tue, 08 Dec 2015 15:29:11 +0000</pubDate>
			<dc:creator>Miriam Posner</dc:creator>
			<guid isPermaLink="false">2364@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;Oh, check &#60;a href=&#34;http://dhresourcesforprojectbuilding.pbworks.com/w/page/69244469/Data%20Collections%20and%20Datasets#demo-corpora&#34;&#62;this out&#60;/a&#62;, from Alan Liu.
&#60;/p&#62;</description>
		</item>
		<item>
			 
				<title>Shawn on "Open Corpora for Digital History Assignment"</title>
						<link>http://digitalhumanities.org/answers/topic/open-corpora-for-digital-history-assignment#post-2363</link>
			<pubDate>Tue, 08 Dec 2015 15:13:53 +0000</pubDate>
			<dc:creator>Shawn</dc:creator>
			<guid isPermaLink="false">2363@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;Hi - check out Melodee Beal's 'scissors and paste' &#60;a href=&#34;http://www.scissorsandpaste.net/&#34; rel=&#34;nofollow&#34;&#62;http://www.scissorsandpaste.net/&#60;/a&#62; source &#60;a href=&#34;https://github.com/mhbeals/scissorsandpaste/tree/master/Outputs&#34; rel=&#34;nofollow&#34;&#62;https://github.com/mhbeals/scissorsandpaste/tree/master/Outputs&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;Also MSU libraries: &#60;a href=&#34;https://www.lib.msu.edu/dh/humdata/&#34; rel=&#34;nofollow&#34;&#62;https://www.lib.msu.edu/dh/humdata/&#60;/a&#62;&#60;/p&#62;
&#60;p&#62;and this from Sharon Howard - &#60;a href=&#34;http://sharonhoward.github.io/cdt/&#34; rel=&#34;nofollow&#34;&#62;http://sharonhoward.github.io/cdt/&#60;/a&#62;
&#60;/p&#62;</description>
		</item>
		<item>
			 
				<title>mattprice on "Open Corpora for Digital History Assignment"</title>
						<link>http://digitalhumanities.org/answers/topic/open-corpora-for-digital-history-assignment#post-2362</link>
			<pubDate>Tue, 08 Dec 2015 14:50:25 +0000</pubDate>
			<dc:creator>mattprice</dc:creator>
			<guid isPermaLink="false">2362@http://digitalhumanities.org/answers/</guid>
			<description>&#60;p&#62;Hi,&#60;br /&#62;
I'm putting together assignments for next semester's digital history class, and want to construct a simple distant reading for my students, probably using Voyant Tools (unless there is a very easy-to-use pure HTML/Javascript set of tools that will let my students use some of the basic JS skills they'll have acquired in their previous assignment).  &#60;/p&#62;
&#60;p&#62;I would like to present them with existing corpora of historical texts: preferably not literature, but newspapers/government documents, letters etc. Most archives I've found use PDF images with mediocre to poor OCR.  Can anyone point me to a good collection of historical corpora that students can experiment with?  &#60;/p&#62;
&#60;p&#62;Thank you!
&#60;/p&#62;</description>
		</item>

	</channel>
</rss>
